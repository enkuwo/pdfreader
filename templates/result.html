<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Summary Result</title>

    <!-- External CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="container">
    <h2>PDF Summary</h2>

    <!-- Tab buttons -->
    <div class="tab-buttons">
        <button onclick="showTab('summary')">üìù Summary</button>
        <button onclick="showTab('chart')">üìä Chart</button>
        <button onclick="showTab('table')">üìã Table</button>
    </div>

    <!-- Search -->
    <input type="text" id="searchInput" placeholder="Search in summary..." oninput="searchSummary()">

    <!-- Summary Tab -->
    <div id="tab-summary" class="tab-content active summary-block">
        {{ summary|safe }}
    </div>

    <!-- Chart Tab -->
    <div id="tab-chart" class="tab-content">
        <canvas id="myChart" width="100%" height="60"></canvas>
    </div>

    <!-- Table Tab -->
    <div id="tab-table" class="tab-content">
        <table>
            <thead>
                <tr><th>Keyword</th><th>Count</th></tr>
            </thead>
            <tbody>
                <tr><td>example</td><td>5</td></tr>
                <tr><td>data</td><td>3</td></tr>
            </tbody>
        </table>
    </div>

    <!-- Download -->
    <form action="/download" method="post" class="download-form">
        <input type="hidden" name="summary" value="{{ summary }}">
        <label for="filetype">Download as:</label>
        <select name="filetype">
              <option value="word">Word (.docx)</option>
            <option value="pdf">PDF (.pdf)</option>
        </select>
        <button type="submit">Download Summary</button>
    </form>

    {% if question %}
        <hr>
        <h3>Question: {{ question }}</h3>
        <div class="summary-block"><strong>Answer:</strong> {{ answer }}</div>
        <br>
        {% if pages %}
            <p><strong>Relevant pages:</strong></p>
            <ul>
                {% for page in pages %}
                    <li><a href="/static/page_images/page_{{ page }}.png" target="_blank">Page {{ page }}</a></li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No exact page match found.</p>
        {% endif %}
    {% endif %}

    <hr>
    <h3>Ask a question about this PDF:</h3>
    <form action="/ask" method="post">
        <input type="text" name="question" placeholder="Ask something..." required style="width: 100%; padding: 10px; margin-bottom: 10px;">
        <button type="submit">Ask</button>
    </form>

    <a href="/">‚¨Ö Back to upload</a>
</div>

<!-- External JS -->
<script src="{{ url_for('static', filename='app.js') }}"></script>

<!-- Chart Init -->
<script>
const ctx = document.getElementById('myChart');
if (ctx) {
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['example', 'data', 'result'],
            datasets: [{
                label: 'Keyword Count',
                data: [5, 3, 2],
                backgroundColor: ['#007bff', '#6c757d', '#28a745']
            }]
        }
    });
}
</script>
</body>
</html>
